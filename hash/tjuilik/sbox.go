package tjuilik

var s3 = [16]byte{
	0xA, 0x5, 0xE, 0xB,
	0x6, 0xD, 0x9, 0x0,
	0xC, 0x8, 0xF, 0x3,
	0x2, 0x4, 0x7, 0x1,
}

var g3 = [16]byte{
	0x0, 0xE, 0xD, 0x3,
	0xF, 0x8, 0x6, 0x4,
	0x9, 0x1, 0xA, 0x7,
	0xB, 0x5, 0xC, 0x2,
}

func applySBox(s *state) {
	var idx int
	for z := 0; z < 4; z++ {
		for y := 0; y < 4; y++ {
			for x := 0; x < 4; x++ {
				v := s[z][y][x] & 0x0F
				if idx%2 == 0 {
					s[z][y][x] = s3[v]
				} else {
					s[z][y][x] = g3[v]
				}
				idx++
			}
		}
	}
}
